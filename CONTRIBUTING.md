Немного теории для предупреждения ошибок.
Параметры перехода основываются на сопоставлении градусных координат опорных точек геоцентрической СК к местной прямоугольной МСК.

Для понимания:
Геоцентрическая система координат, это система где есть три пространственные координатные оси проходящие через центр земли. Координаты в такой системе имеют вид x,y,z или привычные нам широта и долгота измеряемые градусами угла от нулевой точки через землю lat long h. При этом выстоа h отсчитывается не от центра земли как в первом случае, а от эллипсоида, сферы, геоида (упрощенной модели поверхности земли).
Прямоугольная МСК — система координат построенная на поверхности земли пренебрегающая ее «круглостью». Такие системы координат очень удобны в использовании на небольших расстояниях, позволяют не проводить сложных математических операций для расчета привычных нам расстояний на поверхности земли. Такие МСК часто применяются в строительстве, картографии, геодезии.
Proj4 — программа позволяющая высчитывать координаты точки в разных системах координат по заданным параметрам.

Параметры СК например +proj=omerc +lat_0=59.8338730825 +lonc=33 +alpha=-0.0001 +gamma=-1.771957267229058 +k=0.9996584453038837 +x_0=2365031.423134961 +y_0=426397.2888527482 +ellps=krass
В данном примере указанны параметры прямоугольной МСК. Разберем каждый:
Датум (не обозначено в нашем примере)— нахождение центра земли и углы разворота координатных осей относительно друг друга, в нашем примере не указанны и по умолчанию программа будет использовать датум wgs84
Модель поверхности земли (+ellps=krass)— часто относят к датуму, в нашем случае это эллипсоид Красовского. На этой математической модели поверхности и расположен наш прямоугольник МСК.
Проекция (+proj=omerc) — алгоритм с помощью которого прямоугольные координаты проецируются за круглую землю. Самый распространенный алгоритм это «апельсиновые дольки», если порезать апельсин по долькам, отделить от долек шкурки. Расправленную шкурку положить на лист в клетку и получится проекция Меркатора.
Центр проекции в градусах (+lat_0=59.8338730825 +lonc=33) - это то место, где расправленная шкурка меньше корробица и сопротивляется свернуться обратно, место с наименьшими искажениями. Грубо говоря место где плоский лист МСК прикасается к шарику нашей планеты.
Развороты (+alpha=-0.0001 +gamma=-1.771957267229058) относительно меридиана оси координат МСК.
Масштабный коэффициент (+k=0.9996584453038837), в идеале должен быть единицей. Показывает, на сколько реальное расстояние отличается от координатного.
Координаты прямоугольные центра проекции в метрах (+x_0=2365031.423134961 +y_0=426397.2888527482), можно рассматривать как значение смещения начала отсчета координат.

Теперь рассмотрим, что происходит в нашей веб форме при преобразовании координат:

https://git.armrus.org/open-source/gis...eb.php#L23 тут наши опорные точки в градусах пересчитываются в произвольную проекцию на модели поверхности (на момент написания фиксированное значение — эллипсоид Красовского) по алгоритму (на момент написания фиксированный Меркатора) с центром «апельсиновой дольки» введенным в веб форму.
https://git.armrus.org/open-source/gis...eb.php#L31 тут мы получаем параметры конформного преобразования, т. е. Мы вычисляем параметры на сколько надо расятнуть, сдвинуть, и развернуть наши точки полученные в первом шаге, чтобы получить значения опорных точек из веб формы. При таком преобразовании образуются невязки между метровыми опорными точками из веб формы и вычисленными точками.
https://git.armrus.org/open-source/gis...b.php#L205 собираем результат, где участвует центральная точки из веб формы, тип проекции, датум, смещения, масштаб, развороты.

Анализ полученных данных на качество:
Конечно первое, что бросается в глаза, это невязки. С первого взгляда кажется, что невязки образуются в следствии погрешностей геодезических измерений на опорных точках, это будет так, если убедится, что невязки минимальные при любых других параметрах. Если у нас не верно подобран центр проекции в веб форме, то мы окажемся с другими условиями искажения, и натянутые на МСК точки из WGS по высчитанным параметрам будут слишком разбегаться. На большие невязки влияет так же не правильно выбранный эллипсоид/сфероид/геоид, так как наша расчетная МСК будет проецироваться на плоскость не совсем с той пространственной фигуры, что было задумано у исходной МСК. Ну и конечно, если не верно угадать тип проецирования на плоскость, невязки будут очень большие.
Представим, что мы угадали с центром проекции, и у нас одинаковое искажение по Х и У, в таком случае все невязки скомпенсируются масштабным коэффициентом даже если мы выберем не тот эллипсоид, таким образом может оказаться, что в 10км местности 100 метров лишних координат, такие параметры невозможно будет использовать, потому как невязки теоретические будут вокруг нуля, а на местности будут десятки метров.

Зона действия вычисленных параметров МСК и точность этих параметров:
Используемый нами алгоритм конформного преобразования растягивает и разворачивает вокруг точки. Эта координатная точка получается путем усреднения https://git.armrus.org/open-source/gis...ey.php#L22 Эта средняя точка даже в условиях неверных центров проекции, типа проекции и датума будет совпадать по координатам с реальным положением на местности, а вот отдаляясь от нее в любом направлении будет нарастать ошибка. Вычислить ошибку можно измерив расстояние от средней точки и умножив его на масштаб полученный в параметрах, прибавив среднюю невязку вычисленную усреднением невязки всех используемых в вычислении опорных точек. Таким образом если установить предельную погрешность например для кадастра в 0,1 метра мы сможем сразу отбраковать опорные точки с невязкой более 0,1 метра, далее пересчитав среднюю точку из нового состава опорных точек начертить радиус действия МСК от средней точки отняв от 0,1 среднюю невязку по опорным точкам (пусть будет 0,04), остается 0,06 метра, теперь делим 0,6 на отличающееся от единицы значение масштаба, получаем радиус действия параметров МСК относительно средней точки. 